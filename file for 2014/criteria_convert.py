__author__ = 'keleigong'import openpyxl as ox# create new excel filewb = ox.Workbook()# c_hit_table_target=wb.active#c_hit_table_target.title = "aaaa"target = wb.create_sheet(0, 'hit_table')# Load the existing filec_hit_original = ox.load_workbook(    '/Users/keleigong/Dropbox/Python/Project-SCRC/2008-2013 criteria hit (old criteria ).xlsx')c_hit_from_file = c_hit_original.get_sheet_by_name('pure_value')#List  = c_hit_original.get_sheet_by_name('list')description = c_hit_original.get_sheet_by_name('description_new')#print c_hit_from_file['G456'].value#print c_hit_from_file['G457'].value#print c_hit_from_file['G458'].valuedes_all = {}des_id = {}count = 1category = 1for row in range(1, 142, 1):    temp = str(description.cell('B%s' % (row)).value) + '.' + str(count)    des_id[temp] = description.cell('A%s' % (row)).value    if description.cell('C%s' % (row + 1)).value != description.cell('C%s' % (row)).value:        des_all[category] = des_id        #des_all.append(des_id)        category += 1        des_id = {}    if description.cell('B%s' % (row + 1)).value != description.cell('B%s' % (row)).value:        count = 1    else:        count += 1row_num = 1for row in range(13, 1190, 1):    category_id = 1    for col_idx in range(5, 143, 1):        col = ox.cell.get_column_letter(col_idx)        #print col        if col == 'CS':            index = '4.10'        elif col == 'EC':            index = '4.10'        elif col == 'CI':            index = '3.10'        else:            index = str(c_hit_from_file.cell('%s%s' % (col, 12)).value)        if type(c_hit_from_file.cell('%s%s' % (col, 12)).value) == type(1.1):            target.cell('A%s' % (row_num)).value = c_hit_from_file.cell('A%s' % row).value            target.cell('B%s' % (row_num)).value = c_hit_from_file.cell('B%s' % (row)).value            target.cell('C%s' % (row_num)).value = c_hit_from_file.cell('C%s' % (row)).value            target.cell('D%s' % (row_num)).value = str(c_hit_from_file.cell('D%s' % (row)).value) + '/01/01'            target.cell('E%s' % (row_num)).value = des_all[category_id][index]            if type(c_hit_from_file.cell('%s%s' % (col, row)).value) == type(1.0):                target.cell('F%s' % (row_num)).value = 1            else:                target.cell('F%s' % (row_num)).value = 0            row_num += 1        if type(c_hit_from_file.cell('%s12' % (ox.cell.get_column_letter(col_idx + 3))).value) == type(1.0) and type(                c_hit_from_file.cell('%s12' % (col)).value) == type(1.0):            if int(c_hit_from_file.cell('%s12' % (ox.cell.get_column_letter(col_idx + 3))).value) < int(                    c_hit_from_file.cell('%s12' % (col)).value):                category_id += 1wb.save('hit_by_category_0or1.xlsx')print 'finish'print 'Finish'